#!/bin/bash

# 要添加到 hosts 文件中的 IP 地址和域名
ip_list="140.82.114.3 github.com\n185.199.108.153 assets-cdn.github.com\n199.232.69.194 github.global.ssl.fastly.net\n151.101.0.133 raw.githubusercontent.com"

# 检查 hosts 文件是否已经包含要添加的 IP 地址
if grep -q "$ip_list" /etc/hosts; then
  echo "hosts 文件中已经包含要添加的 IP 地址。"
else
  # 将 IP 地址和域名添加到 hosts 文件中
  if sudo sh -c "echo '$ip_list' >> /etc/hosts"; then
    echo "IP 地址和域名已经成功添加到 hosts 文件中。"
  else
    echo "添加 IP 地址和域名到 hosts 文件失败。"
  fi
fi

read -p "回车更新，z拉取脚本(y/z)" choice

if [[ "$choice" == "y" || "$choice" == "" ]]; then
  echo "开始执行脚本..."
  # 检查是否可以连接到 GitHub 的服务器
  if ping -c 1 github.com &> /dev/null; then
    if bash -c "$(curl -L raw.githubusercontent.com/xiezh123/132/main/6.sh)"; then
      echo "脚本执行完毕。"
    else
      echo "脚本执行失败，请检查网络连接和脚本内容。"
    fi
  else
    echo "无法连接到 GitHub 的服务器，请检查您的网络连接和 DNS 解析设置。"
  fi
elif [[ "$choice" == "z" ]]; then
  echo "确保您的网络连接正常，并且 DNS 解析正确。您可以尝试使用 ping 命令来测试是否可以连接到 GitHub的服务器。"
  if curl -sSL https://github.com/xiezh123/132/raw/main/1 -o /usr/local/bin/z && sudo chmod +x /usr/local/bin/z; then
    sleep 3
    if [[ -f "/usr/local/bin/z" ]]; then
      echo "拉取完成。终端输入z执行脚本"
    else
      echo "命令执行失败，请检查网络连接和命令内容。"
    fi
  else
    echo "命令执行失败，请检查网络连接和命令内容。"
  fi
else
  echo "无效的选项：$choice"
fi
